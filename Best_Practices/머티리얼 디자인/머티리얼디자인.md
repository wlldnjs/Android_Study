### 머티리얼 디자인을 이용하여 앱 제작

> ### 머티리얼 테마 적용

머티리얼 테마는 다음과 같은 기능을 제공합니다.

- 시스템 위젯에 색상 지정
- 시스템 위젯의 터치 애니메이션
- 액티비티 전환 애니메이션

머티리얼 테마를 적용하려면 아래와 같이 android:Theme.Material를 상속하는 테마를 지정해야 합니다.

- @android:style/Theme.Material (어두운 버전)
- @android:style/Theme.Material.Light (밝은 버전)
- @android:style/Theme.Material.Light.DarkActionBar

``` xml
<!-- res/values/styles.xml -->
<resources>
  <!-- your theme inherits from the material theme -->
  <style name="AppTheme" parent="android:Theme.Material">
    <!-- theme customizations -->
  </style>
</resources>
```

![머터리얼 다크테마](https://developer.android.com/design/material/images/MaterialDark.png)
![머터리얼 화이트테마](https://developer.android.com/design/material/images/MaterialLight.png)

#### 색상표 사용자 지정

테마의 기본 색상을 앱에 맞게 커스터마이징 하려면 상속된 머티리얼 테마의 속성에서 사용자 지정 색상을 정의합니다.

``` xml
<resources>
  <!-- inherit from the material theme -->
  <style name="AppTheme" parent="android:Theme.Material">
    <!-- Main theme colors -->
    <!--   your app branding color for the app bar -->
    <item name="android:colorPrimary">@color/primary</item>
    <!--   darker variant for the status bar and contextual app bars -->
    <item name="android:colorPrimaryDark">@color/primary_dark</item>
    <!--   theme UI controls like checkboxes and text fields -->
    <item name="android:colorAccent">@color/accent</item>
  </style>
</resources>
```

#### 상태 표시줄 사용자 지정

머티리얼 테마를 사용하면 상태표시줄을 손쉽게 변경 가능합니다.
상태표시줄의 색상을 변경하려면 android:statusBarColor 속성을 사용하여 쉽게 변경할 수 있습니다.
android:statusBarColor의 기본값은 android:colorPrimaryDark의 값을 상속받습니다.
또한 android:statusBarColor 속성을 @android:color/transparent로 지정함으로써 반투명하게 표시되게 할 수 있습니다.
그리고 자바 코드상에서 Window.setStatusBarColor() 메서드를 이용하여 애니메이션과 페이드 효과를 줄 수 있습니다,

![테마의 각 부위 명칭](https://developer.android.com/training/material/images/ThemeColors.png)

#### 각 뷰의 테마 지정

Xml의 레이아웃 요소들에는 테마 리소스를 참조하는 android:theme 속성을 지정 할 수 있습니다.
이 속성은 각 뷰와 그 하위 요소들의 테마를 변경합니다.

> ### 목록 및 카드 생성

앱에서 머티리얼 디자인 스타일로 리스트와 카드형태의 리스트를 생성하려면 RecyclerView와 CardView 위젯을 사용합니다.

#### 카드 생성

CardView는 FrameLayout 클래스를 상속받으며, 둥근 모서리와 그림자를 가질 수 있습니다.
또한 정보들을 카드 내에 일관된 모습으로 표시할 수 있습니다.

- card_view:cardElevation : 그림자가 있는 카드 생성
- card_view:cardCornerRadius : 레이아웃에서의 모서리 둥글기 설정
- CardView.setRadius : 자바 코드에서의 모서리 둥글기 설정
- card_view:cardBackgroundColor : 카드의 배경색 설정

``` xml
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:card_view="http://schemas.android.com/apk/res-auto"
    ... >
    <!-- A CardView that contains a TextView -->
    <android.support.v7.widget.CardView
        xmlns:card_view="http://schemas.android.com/apk/res-auto"
        android:id="@+id/card_view"
        android:layout_gravity="center"
        android:layout_width="200dp"
        android:layout_height="200dp"
        card_view:cardCornerRadius="4dp">

        <TextView
            android:id="@+id/info_text"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />
    </android.support.v7.widget.CardView>
</LinearLayout>
```

    * api 21 이전 버전에서는 support v7 라이브러리를 Gradle의 dependency에 추가하여 호환성을 유지해야 합니다.


> ### 그림자 정의 및 뷰 클리핑

머티리얼 디자인에서는 뷰에 android:elevation 속성을 줄 수 있습니다.
elevation 속성은 Z축으로 표현되며 값이 클수록 크고 부드러운 그림자를 그립니다. 
또한 높은 elevation 값을 가진 뷰는 낮은 elevation 값을 가진 뷰를 가리지만, elevation 값이 크기에 영향을 미치지는 않습니다.



### 뷰 클리핑 

다른 디자인 요소와의 일관성 또는 사용자의 입력에 응답하기 위해 뷰를 클리핑 할 수 있습니다. 
android:clipToOutline 특성을 사용하여 뷰의 윤곽선을 클리핑 할 수 있으며, Outline.canClip() 메서드를 통해 사각형, 원형, 둥근사각형 등으로 클리핑이 가능합니다. 
Drawable의 모양으로 뷰를 클리핑 하기 위해서는 Drawable을 해당 뷰의 배경으로 지정하고 View.setClipToOutline()메서드를 호출함으로써 클리핑 할 수 있습니다. 
하지만 뷰 클리핑은 리소스 소모가 크기 때문에, 뷰를 클리핑함과 동시에 애니메이션 효과를 넣는것은 성능이 하락될 수 있습니다. 


### Drawable 사용(API 21레벨 이상) 

아래와 같은 기능들은 앱에서 머티리얼 디자인을 구현하는 데 도움이 됩니다. 

- 드로어블에 색상 적용 
- 주요 색상 추출 
- 벡터 드로어블 

#### 드로어블에 tint 적용 

알파 마스크로 정의된 비트맵 또는 나인패치에 tint를 지정할 수 있습니다. 
색상 리소스 또는 테마의 속성을 사용하여 tint를 적용할 수 있습니다(예를들어 ?android:attr/colorPrimary). 
setTint() 메서드를 사용하여 BitmapDrawable 또는 NinePatchDrawable 객체에 tint를 적용할 수 있습니다. 
또한 android:tint 및 android:tintMode 특성으로 레이아웃에 tint 색상과 모드를 설정할 수 있습니다. 

#### 주요 색상 추출 

안드로이드에는 주요 색상을 추출할 수 있는 Palette클래스가 있습니다. 

- Light Vibrant 
- Vibrant 
- Dark Vibrant 
- Light Muted 
- Muted 
- Dark Muted 

이러한 색상을 추출하려면, 이미지를 불러올 배경 스레드에서 Palette.generate() 메서드로 Bitmap 객체를 전달합니다. 
스레드를 사용할 수 없는 경우, 대신 Palette.generateAsync() 메서드를 호출하고 Listener를 제공합니다. 
Palette.getVibrantColor와 같은 Palette 클래스의 getter 메서드를 사용하여 이미지에서 주요 색상을 추출할 수 있습니다. 

![팔레트 색상](https://developer.android.com/training/material/images/palette-library-color-profiles_2-1_2x.png) 

또한 Palette 클래스를 사용하기 위해서는 support-v7 클래스를 gradle에 추가하여야 합니다. 

``` java 
dependencies { 
  ... 
  compile 'com.android.support:palette-v7:21.0.0' 
} 
``` 

### 벡터 드로어블 생성 

비트맵 이미지는 각 밀도마다 리소스 파일이 필요한 반면에, 벡터 이미지는 배율을 조절해도 이미지가 손상되지 않기 때문에 히나의 리소스 파일만 필요하게 됩니다. 
벡터 이미지를 생성하기 위해서는 <vector> XML 요소 안에 모양의 세부정보를 정의합니다. 

``` xml 
<!-- res/drawable/battery_charging.xml --> 
<vector xmlns:android="http://schemas.android.com/apk/res/android" 
  <!-- intrinsic size of the drawable --> 
  android:height="24dp" 
  android:width="24dp" 
  <!-- size of the virtual canvas --> 
  android:viewportWidth="24.0" 
  android:viewportHeight="24.0"> 
  <group 
  android:name="rotationGroup" 
  android:pivotX="10.0" 
  android:pivotY="10.0" 
  android:rotation="15.0" > 
  <path 
  android:name="vect" 
  android:fillColor="#FF000000" 
  android:pathData="M15.67,4H14V2h-4v2H8.33C7.6,4 7,4.6 7,5.33V9h4.93L13,7v2h4V5.33C17,4.6 16.4,4 15.67,4z" 
  android:fillAlpha=".3"/> 
  <path 
  android:name="draw" 
  android:fillColor="#FF000000" 
  android:pathData="M13,12.5h2L11,20v-5.5H9L11.93,9H7v11.67C7,21.4 7.6,22 8.33,22h7.33c0.74,0 1.34,-0.6 1.34,-1.33V9h-4v3.5z"/> 
  </group> 
</vector> 
``` 

![벡터 이미지](https://developer.android.com/images/guide/topics/graphics/ic_battery_charging_80_black_24dp.png) 


벡터 이미지는 안드로이드 상에서 VectorDrable 객체로 나타나게 됩니다. 

### 사용자 지정 애니메이션 

머티리얼 디자인에서 애니메이션은 사용자에게 자신의 동작에 대한 피드백을 제공하고, 앱과 상호작용할 때 시각적 연속성을 제공합니다. 
머티리얼 테마는 버튼 및 액티비티 전환을 위한 몇 가지 기본 애니메이션을 제공합니다 
사용자는 이러한 애니메이션을 지정하거나 새로운 애니메이션을 만들 수 있습니다. 

- 터치 피드백 
- 나타내기 효과 
- 액티비티 전환 
- 커브 모션 
- 뷰 상태 변경 

#### 터치 피드백 

머티리얼 디자인의 터치 피드백은 사용자가 UI요소와 상호작용할 때 시각적으로 바로 확인할 수 있습니다. 
버튼의 기본적인 터치 피드백 애니메이션은 물결 효과와 함께 상태가 변화하는 RippleDrawable 클래스를 사용합니다. 
RippleDrawable은 다음과 같은 속성이 있습니다. 

- ?android:attr/selectableItemBackground : 물결이 뷰를 넘지 못함 
- ?android:attr/selectableItemBackgroundBorderless : 물결이 뷰를 넘어감(API 21이상) 

또한 ripple 속성을 사용하여 RippleDrawable을 xml 리소스로 정의할 수 있습니다. 
그리고 RippleDrawable 객체에 색상을 지정할 수 있으며, 기본 터치 피드백 색상을 변경하려면 테마의 android:colorControlHighlight 속성을 변경해야 합니다. 


#### 나타내기 효과 

표시 애니메이션은 UI요소 그룹을 표시하거나 숨길 때 사용자에게 시각적인 연속성을 제공합니다. 
ViewAnimationUtils.createCircularReveal() 메서드를 사용하여 원형 클리핑을 이용하여 뷰를 표시하거나 숨길 수 있습니다. 

이전에 보이지 않던 뷰를 나타내는 예제 

``` java 
// previously invisible view 
View myView = findViewById(R.id.my_view); 

// get the center for the clipping circle 
int cx = (myView.getLeft() + myView.getRight()) / 2; 
int cy = (myView.getTop() + myView.getBottom()) / 2; 

// get the final radius for the clipping circle 
int finalRadius = Math.max(myView.getWidth(), myView.getHeight()); 

// create the animator for this view (the start radius is zero) 
Animator anim = 
  ViewAnimationUtils.createCircularReveal(myView, cx, cy, 0, finalRadius); 

// make the view visible and start the animation 
myView.setVisibility(View.VISIBLE); 
anim.start(); 
``` 

뷰를 보이지 않게 해주는 예제 

``` java 
// previously visible view 
final View myView = findViewById(R.id.my_view); 

// get the center for the clipping circle 
int cx = (myView.getLeft() + myView.getRight()) / 2; 
int cy = (myView.getTop() + myView.getBottom()) / 2; 

// get the initial radius for the clipping circle 
int initialRadius = myView.getWidth(); 

// create the animation (the final radius is zero) 
Animator anim = 
  ViewAnimationUtils.createCircularReveal(myView, cx, cy, initialRadius, 0); 

// make the view invisible when the animation is done 
anim.addListener(new AnimatorListenerAdapter() { 
  @Override 
  public void onAnimationEnd(Animator animation) { 
  super.onAnimationEnd(animation); 
  myView.setVisibility(View.INVISIBLE); 
  } 
}); 

// start the animation 
anim.start(); 
``` 

#### 액티비티 전환 

머티리얼 디자인앱에서의 액티비티 전환은 공통된 요소간의 모션과 transition을 통해 서로 다른 상태를 시각적으로 연결합니다. 
들어가기와 나가기 상태로 전환될 때 액티비티간의 공유되는 요소에 대한 애니메이션을 지정할 수 있습니다. 

- 들어가기 : 
- 나가기 : 
- 공유요소 : 

